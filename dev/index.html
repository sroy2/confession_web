<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset=UTF-8>
  <title>your confession...</title>
  <!--[if lt IE 9]><script src=./js/html5.js></script><![endif]-->
  <link href=style.css rel=stylesheet />
  <!--[if lt IE 9]><link href=ie.css rel=stylesheet /><![endif]-->
  <script type="text/javascript" src="./js/jquery.min.js"></script>
  <script type="text/javascript" src="./js/bbq.min.js"></script>
  <script type="text/javascript">
  function menu(obj, ul) {
    $.each(obj, function(k, v) {
        if ("menu" in v) $("<li>",{id:"dropdown"}).append($("<a>",{href:"#"+v.item}).append(v.item),menu(v.menu, $("<ul>",{id:"subMenu"}))).appendTo(ul);
        else $("<a>",{href:"#"+v.item}).append(v.item).appendTo($("<li>").appendTo(ul));});
    return ul;
  } 
  function make_article(tag) {
    /*
      Here is where most of the work will be done pulling data.
      We can set this up to:
        a) pull from a database
        b) pull from a json file (site.js)
        c) pull from different json files ([tag].js) 
        d) do something else completely unrelated...
      Right now its just returning some text and not pulling anything.
    */
    return $("<article>").append($("<header>").append($("<h1>").append(tag))).append($("<div>").append($("<p>").append("Some temporary text...")));
  }
  $(function() {
    $(document).ready(function() {
      $.getJSON("./js/site.js",function(data) { 
        $("<h2>").html(data.ip+" - "+data.name).appendTo("hgroup");
        menu(data.menu, $("<ul>")).appendTo("nav#global");
      });
    });
  });
  $(function(){
    var cache =  {'': $('.bbq-default')};
    $(window).bind('hashchange', function(e) {
      var url = $.param.fragment();
      $('.bbq-content').children(':visible').hide(); // hide ajax loader
      if (cache[url]) {
        cache[url].show();
      } else {
        $('.bbq-loading').show();
        cache[url] = make_article(url).appendTo('#main').load(url, function() {
          $('.bbq-loading').hide();});
      }
    })
    $(window).trigger('hashchange');
  });
  </script>
</head>
<body>
<div id="wrap">
  <header>
    <hgroup>
      <h1><a href="#">confession</h1>
    </hgroup>
    <nav id=global>
    </nav>
  </header>
  <div id="main" class="bbq-content">
    <article class="bbq-loading" style="display:none;">
      <header><h1>Loading...</h1></header>
    </article>
    <article class="bbq-default bbq-item" style="display:block;">
      <header><h1>Welcome</h1></header>
      <div><p>This is the main welcome text.</p></div>
    </article>
  </div>
</div>
<footer>
  <p>Copyright &copy; 2012 <strong>The Ninja Collective</strong>. All Rights Reserved.</p>
</footer>
</body>
</html>
