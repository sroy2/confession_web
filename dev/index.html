<html lang=en>
<head>
  <meta charset=UTF-8>
  <title>your confession...</title>
  <link href=style2.css rel=stylesheet />
  <script type="text/javascript" src="./js/jquery.min.js"></script>
  <script type="text/javascript" src="./js/bbq.min.js"></script>
  <script text="text/javascript" src="./js/datatables.min.js"></script>
  <script type="text/javascript">
  var file = "./js/site.js"; // current file we are pulling from
  var json = "";             // json data from current file
  function menu(obj, ele) {
    $.each(obj, function(k, v) {
        if (typeof(v) === 'string') { $("<a>", {href: "#" + v }).append(v).appendTo($("<li>").appendTo(ele));
        } else if (v instanceof Array && typeof k === "string") { for (var i = 0, l = v.length; i < l; i++) { $("<li>").append($("<a>",{href:"#"+k}).append(k), menu(v, $("<ul>"))).appendTo(ele); }
        } else { for (key in v) { $("<li>", { id: "dropdown" }).append($("<a>",{href:"#"+key}).append(key), menu(v[key], $("<ul>"))).appendTo(ele); }}
    });
    return ele;
  }
  //fucntion make_table(tag) {
  function make_article(tag) {
    /*
      Here is where most of the work will be done pulling data.
      Right now it is relying on the menu() to have already loaded the json file so we can pull from it.
    */
      return $("<article>").append($("<header>").append($("<h1>").append(tag))).append($("<div>").append($("<p>").append(JSON.stringify(json[tag]))));
  }
  $(function() {
    $(document).ready(function() {
      $.getJSON(file,function(data) { 
        json = data;
        $("<h2>").html(data.ip+" - "+data.name).appendTo("hgroup");
        $("<a>",{href:file}).append(file).appendTo(".default p");
        menu(data.menu, $("<ul>",{id:"nav"})).appendTo("nav");
      });
      $('#example').dataTable({
        "sScrollY": "200px", "bPaginate": false
      });
    });
  });
  $(function(){
    var cache =  {'': $('.default')};
    $(window).bind('hashchange', function(e) {
      var tag = $.param.fragment();           // set hashtag
      $('#main').children(':visible').hide(); // hide open articles
      if (cache[tag]) cache[tag].show();
      else cache[tag] = make_article(tag).appendTo('#main');
    })
    $(window).trigger('hashchange');
  });
  </script>
</head>
  <body>
    <div id="wrap">
      <header>
        <hgroup>
          <h1><a href="#">confession</a></h1>
          <h2></h2>
        </hgroup>
        <nav></nav>
      </header>
      <div id="main">
        <article class="default">
          <header>
            <h1>Welcome</h1>
          </header>
          <p><a href="#TEST">Test Table</a><br />JSON source: </p>
        </article>
      </div>
    </div>
    <footer>
      <p>Copyright &copy; 2012 <strong>The Ninja Collective</strong>. All Rights Reserved.</p>
    </footer>
  </body>
</html>