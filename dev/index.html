<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset=UTF-8>
  <title>your confession...</title>
  <!--[if lt IE 9]><script src=./js/html5.js></script><![endif]-->
  <link href=style.css rel=stylesheet />
  <!--[if lt IE 9]><link href=ie.css rel=stylesheet /><![endif]-->
  <script type="text/javascript" src="./js/jquery.min.js"></script>
  <script type="text/javascript" src="./js/bbq.min.js"></script>
  <script type="text/javascript">
  var file = "./js/site.js"; // current file we are pulling from
  var json = "";             // json data from current file
  function menu(obj, ul) {
    $.each(obj, function(k, v) {
        if ("menu" in v) $("<li>",{id:"dropdown"}).append($("<a>",{href:"#"+v.item}).append(v.item),menu(v.menu, $("<ul>",{id:"subMenu"}))).appendTo(ul);
        else $("<a>",{href:"#"+v.item}).append(v.item).appendTo($("<li>").appendTo(ul));});
    return ul;
  } 
  function make_article(tag) {
    /*
      Here is where most of the work will be done pulling data.
      Right now it is relying on the menu() to have already loaded the json file so we can pull from it.
    */
      return $("<article>").append($("<header>").append($("<h1>").append(tag))).append($("<div>").append($("<p>").append(JSON.stringify(json[tag]))));
  }
  $(function() {
    $(document).ready(function() {
      $.getJSON(file,function(data) { 
        json = data;
        $("<h2>").html(data.ip+" - "+data.name).appendTo("hgroup");
        $("<a>",{href:file}).append(file).appendTo(".default p");
        menu(data.menu, $("<ul>")).appendTo("nav#global");
      });
    });
  });
  $(function(){
    var cache =  {'': $('.default')};
    $(window).bind('hashchange', function(e) {
      var tag = $.param.fragment();           // set hashtag
      $('#main').children(':visible').hide(); // hide open articles
      if (cache[tag]) cache[tag].show();
      else cache[tag] = make_article(tag).appendTo('#main');
    })
    $(window).trigger('hashchange');
  });
  </script>
</head>
<body>
<div id="wrap">
  <header>
    <hgroup>
      <h1><a href="#">confession</a></h1>
    </hgroup>
    <nav id=global>
    </nav>
  </header>
  <div id="main">
    <article class="default" style="display:block;">
      <header><h1>Welcome</h1></header>
      <p>You are currently looking at: </p>
    </article>
  </div>
</div>
<footer>
  <p>Copyright &copy; 2012 <strong>The Ninja Collective</strong>. All Rights Reserved.</p>
</footer>
</body>
</html>